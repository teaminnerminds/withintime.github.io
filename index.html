<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Within Time | Official Site</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="logotransp.png" />

  <!-- Fonts & GSAP -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Unbounded', sans-serif; background: #0b0710; color: #eee; overflow-x: hidden; }

    /* ================= PRELOADER UPGRADE ================= */
    #preloader {
      position: fixed;
      inset: 0;
      background: #0b0710;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.8s ease-out;
    }
    #preloader img {
      width: 160px;
      opacity: 0;
      animation:
        fadeInPre 1.4s ease forwards,
        pulsePre 2.6s ease-in-out infinite 1.4s,
        shimmerPre 4.5s ease-in-out infinite 1.4s;
      filter: drop-shadow(0 0 8px rgba(164,122,255,0.3));
    }
    @keyframes fadeInPre {
      from { opacity: 0; transform: scale(0.85); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes pulsePre {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    @keyframes shimmerPre {
      0% { filter: drop-shadow(0 0 8px rgba(164,122,255,0.3)); }
      50% { filter: drop-shadow(0 0 20px rgba(164,122,255,0.65)); }
      100% { filter: drop-shadow(0 0 8px rgba(164,122,255,0.3)); }
    }
    #preloader.fade-out {
      opacity: 0;
      pointer-events: none;
    }

    /* Hero Section */
    #hero { position: relative; height: 100vh; display: flex; align-items: center; justify-content: center; flex-direction: column; overflow: hidden; }
    #hero::before {
      content: "";
      position: absolute; inset: 0;
      background: url('bigimageforweb.png') center/cover no-repeat;
      filter: brightness(0.6);
      z-index: 1;
      animation: bg-drift 38s ease-in-out infinite alternate;
    }
    #hero::after {
      content: "";
      position: absolute; left: 0; bottom: 0; width: 100%; height: 40%;
      background: linear-gradient(to bottom, rgba(0,0,0,0) 0%, #0b0710 100%);
      z-index: 2;
    }
    #hero img { width: 45vmin; position: relative; z-index: 3; opacity: 0; transform: scale(0.85); }

    /* Sections */
    section { min-height: 100vh; display: flex; align-items: center; justify-content: center; flex-direction: column; text-align: center; padding: 3rem 1rem; position: relative; overflow: hidden; }
    h2 { color: #d7c4ff; margin-bottom: 1.5rem; font-size: 2rem; }

    /* Trailer */
    .trailer-section iframe { width: 80%; height: 60vh; border: 3px solid #a47aff; border-radius: 10px; box-shadow: 0 0 30px #4b2a7d; }

    /* Scroll-ins */
    .reveal { opacity: 0; transform: translateX(-80px); }
    .reveal-right { opacity: 0; transform: translateX(80px); }

    /* Story Gallery */
    .story-gallery { display: flex; gap: 1.5rem; margin-top: 2rem; flex-wrap: wrap; justify-content: center; }
    .story-gallery img { width: clamp(240px, 28vw, 420px); border-radius: 10px; box-shadow: 0 0 22px rgba(90,59,141,0.55); }

    /* Features */
    .features-list { display: flex; flex-direction: column; gap: 1.5rem; max-width: 700px; }

    /* Characters */
    #characters-section { display:flex;align-items:center;justify-content:center;flex-direction:row;gap:4rem;min-height:100vh;padding:4rem 2rem; }
    .char-panel { position:relative;width:45%;height:85vh;display:flex;align-items:center;justify-content:center; }
    #charSilhouette{
      -webkit-mask-image: linear-gradient(to bottom, rgba(255,255,255,1) 62%, rgba(255,255,255,0) 100%);
              mask-image: linear-gradient(to bottom, rgba(255,255,255,1) 62%, rgba(255,255,255,0) 100%);
      filter: drop-shadow(0 0 20px rgba(164,122,255,0.45));
      animation: char-glitch-loop 6s linear infinite;
    }

    /* Footer */
    footer { padding: 2rem; text-align:center; background:#0a050f; color:#777; }
    footer a { color: #a47aff; text-decoration:none; }
    footer a:hover { color:#fff; }

    /* Audio Toggle */
    #audioToggle{position:fixed; right:18px; bottom:18px; width:44px; height:44px; border-radius:999px; background:#1a1126; border:1px solid #3b2a56; display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:999; }

    /* Hero particles */
    #hero-particles { position:absolute; inset:0; z-index:2; pointer-events:none; }

    /* Logo float */
    #hero-logo { animation: hero-float 6s ease-in-out infinite alternate; }
    @keyframes hero-float { 0% { transform: translateY(-4px); } 100% { transform: translateY(6px); } }

    /* Responsive */
    @media (max-width: 900px) {
      #characters-section { flex-direction:column; gap:2rem; padding:3.5rem 1rem; }
      .char-panel { width:100%; height:60vh; }
      .char-info { width:88%; text-align:center; }
    }
  </style>
</head>

<body>

  <!-- Preloader -->
  <div id="preloader"><img src="logotransp.png" alt="Loading"></div>

  <!-- Hero -->
  <section id="hero">
    <canvas id="hero-particles"></canvas>
    <img src="logotransp.png" id="hero-logo" alt="Within Time Logo" />
  </section>

  <!-- Trailer -->
  <section class="trailer-section reveal">
    <h2>Watch the Trailer</h2>
    <iframe src="https://www.youtube.com/embed/AZx1WWpc7b0" frameborder="0" allowfullscreen></iframe>
  </section>

  <!-- Story -->
  <section class="reveal-right">
    <h2>The Story</h2>
    <div style="max-width:1000px; text-align:left; font-size:1.05rem; line-height:1.8; color:#e8e0ff;">
      <p><strong>Six months</strong> remain before the fate of two worlds is sealed...</p>
      <p>With hopes of gaining answers...</p>
      <p style="color:#cbb5ff;"><strong>FATE CHANGES FOR NO ONE.</strong></p>
    </div>
    <div class="story-gallery">
      <img src="groupdiscuss.png">
      <img src="firsteterniatime.png">
      <img src="gravesitepioc.jpg">
    </div>
  </section>

  <!-- Gameplay -->
  <section class="reveal">
    <h2>Gameplay & Content</h2>
    <img src="titlescreenonepen.png" style="width:70%;border-radius:8px;margin-bottom:2rem;box-shadow:0 0 30px #4b2a7d;">
    <div class="features-list">
      <p>üéÆ <strong>13 Unique Playable Characters</strong></p>
      <p>‚è≥ <strong>Exclusive STANCE Combat System</strong></p>
      <p>üåç <strong>Explore 9 Unique Regions</strong></p>
      <p>üéôÔ∏è <strong>Fully Voiced Cutscenes & Encounters</strong></p>
      <p>üéº <strong>200+ Track OST by Oxiqa</strong></p>
      <p>üèÜ <strong>100+ Achievements</strong></p>
    </div>
  </section>

  <!-- Characters -->
  <section class="characters reveal-right" id="characters-section">
    <div class="char-panel">
      <img class="moon-back" src="logotransp.png"
        style="position:absolute;height:105%;opacity:0.24;filter:saturate(0) drop-shadow(0 0 38px rgba(164,122,255,0.75));pointer-events:none;" />
      <canvas id="charParticles" style="position:absolute;width:100%;height:100%;pointer-events:none;"></canvas>
      <img id="charSilhouette" src="yunissilouhette.png" style="height:90%;opacity:0;transform:scale(0.95);" />
    </div>

    <div class="char-info" style="width:40%;text-align:left;">
      <h2 id="charName" style="font-size:2.6rem;margin-bottom:0.5rem;color:#d7c4ff;">Yunis Caelum</h2>
      <h3 id="charRole" style="font-size:1.25rem;margin-bottom:1.5rem;color:#a88ce9;">Leader of the Scions of Fate</h3>
      <p id="charDesc" style="font-size:1.05rem;line-height:1.65;color:#e8e0ff;opacity:0;">A calm and collected leader...</p>

      <div style="display:flex;justify-content:space-between;margin-top:2.5rem;">
        <button id="charPrev">‚Üê Prev</button>
        <button id="charNext">Next ‚Üí</button>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <p>Follow us:</p>
    <a href="https://store.steampowered.com/app/2302230/Within_Time/">Steam</a> |
    <a href="https://www.youtube.com/@withintimegame">YouTube</a>
    <p>&copy; 2025 Team INNERMINDS</p>
  </footer>

  <div style="width:100%;text-align:center;margin:3rem 0;">
    <a href="https://store.steampowered.com/app/2302230/Within_Time/" target="_blank" style="padding:1rem 2.2rem;border:2px solid #cbb5ff;border-radius:8px;color:#e8e0ff;">Wishlist on Steam</a>
  </div>

  <!-- Ambient audio -->
  <audio id="ambience" src="Track 1 - Re;Start.mp3" loop preload="none"></audio>

  <button id="audioToggle">
    <svg id="icon-sound-on" viewBox="0 0 24 24"><path d="M3 10v4h4l5 5V5L7 10H3z"></path></svg>
    <svg id="icon-sound-off" viewBox="0 0 24 24" style="display:none;"><path d="M3 10v4h4l5 5V5L7 10H3z"></path></svg>
  </button>

  <script>
    /* PRELOADER ‚Üí FADE OUT, LOGO FADE IN */
    window.addEventListener('load', () => {
      const p = document.getElementById('preloader');
      setTimeout(() => p.classList.add('fade-out'), 1300);
      gsap.to('#hero-logo', { opacity: 1, scale: 1, duration: 1.4, ease: 'power2.out' });
    });

    gsap.registerPlugin(ScrollTrigger);

    gsap.utils.toArray('.reveal').forEach(el => {
      gsap.fromTo(el, {opacity:0,x:-80},{opacity:1,x:0,duration:1.1,scrollTrigger:{trigger:el,start:'top 80%'}})
    });
    gsap.utils.toArray('.reveal-right').forEach(el => {
      gsap.fromTo(el,{opacity:0,x:80},{opacity:1,x:0,duration:1.1,scrollTrigger:{trigger:el,start:'top 80%'}})
    });

    /* Character Switcher (unchanged) */
    let index = 0;
    const characters = [
      { name: 'Yunis Caelum', role: 'The Light of Humanity - VA: AnimilkyVA', img: 'yunissilouhette.png', desc: 'YUNIS is the leader...' },
      { name: 'Estella Kisiel', role: 'The Visionary - VA: Miss Emilie ', img: 'estellasilouhette.png', desc: 'ESTELLA is the brains...' },
      { name: 'Angie Alfaro', role: 'The Ember Soul - VA: Rosealin', img: 'angiesilouhette.png', desc: 'ANGIE is the most well rounded...' },
      { name: 'Rictor Fitzsimmons', role: 'The Iron Heart of Cinceria - VA: Cameron Judd', img: 'rictorsilouhette.png', desc: 'RICTOR is the muscle...' }
    ];
    const nameEl = document.getElementById('charName');
    const roleEl = document.getElementById('charRole');
    const descEl = document.getElementById('charDesc');
    const imgEl = document.getElementById('charSilhouette');

    function showCharacter(i) {
      const c = characters[i];
      gsap.to([imgEl, descEl, nameEl, roleEl], { opacity: 0, duration: 0.18, onComplete: () => {
        nameEl.textContent = c.name;
        roleEl.textContent = c.role;
        descEl.textContent = c.desc;
        imgEl.src = c.img;
        gsap.to([imgEl, descEl, nameEl, roleEl], { opacity: 1, duration: 0.45 });
      }});
    }
    showCharacter(index);
    document.getElementById('charNext').onclick = () => { index = (index + 1) % characters.length; showCharacter(index); }
    document.getElementById('charPrev').onclick = () => { index = (index - 1 + characters.length) % characters.length; showCharacter(index); }

    /* Audio Auto-On and Toggle */
    const audio = document.getElementById('ambience');
    let audioStarted = false;
    function startAudio() { if (!audioStarted) { audioStarted = true; audio.volume = 0; audio.play().then(()=> gsap.to(audio,{volume:0.12,duration:2})).catch(()=>{});}}
    ['click','scroll','keydown','mousemove','touchstart'].forEach(ev => window.addEventListener(ev,startAudio,{once:true}));

    (function(){
      const btn = document.getElementById('audioToggle');
      const on = document.getElementById('icon-sound-on');
      const off = document.getElementById('icon-sound-off');
      let enabled = false;
      function setIcons(){ on.style.display = enabled ? 'block' : 'none'; off.style.display = enabled ? 'none' : 'block'; }
      setIcons();
      btn.addEventListener('click', async () => {
        enabled = !enabled; setIcons();
        if (enabled) { if (audio.paused) await audio.play(); gsap.to(audio,{volume:0.12,duration:1.2}); }
        else { gsap.to(audio,{volume:0,duration:1,onComplete:()=>audio.pause()});}
      });
    })();

    /* Hero Particles (unchanged) */
    const hcanvas = document.getElementById('hero-particles');
    const hctx = hcanvas.getContext('2d');
    let hw, hh, hparticles;
    function hresize(){ hw = hcanvas.width = window.innerWidth; hh = hcanvas.height = window.innerHeight;
      hparticles = Array.from({length: 50},()=>({x:Math.random()*hw,y:Math.random()*hh,s:Math.random()*2+1,dx:(Math.random()-0.5)*0.3,dy:(Math.random()-0.5)*0.3,o:Math.random()*0.5+0.25}));
    }
    function hanim(){ hctx.clearRect(0,0,hw,hh); hparticles.forEach(p=>{p.x+=p.dx;p.y+=p.dy;if(p.x<0||p.x>hw)p.dx*=-1;if(p.y<0||p.y>hh)p.dy*=-1;hctx.beginPath();hctx.arc(p.x,p.y,p.s,0,Math.PI*2);hctx.fillStyle=`rgba(164,122,255,${p.o})`;hctx.fill();});requestAnimationFrame(hanim); }
    window.addEventListener('resize', hresize); hresize(); hanim();
  </script>

</body>
</html>
